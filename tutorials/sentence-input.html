<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step 1. Sentence input &mdash; lambeq 0.2.7 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/table-wrap.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Step 2. Diagram rewriting" href="rewrite.html" />
    <link rel="prev" title="Contributing to lambeq" href="../CONTRIBUTING.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> lambeq
            <img src="../_static/lambeq_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.2.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parsing.html">Syntactic parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../string_diagrams.html">String diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discopy.html">DisCoPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use-cases.html">lambeq use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to lambeq</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Step 1. Sentence input</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Syntax-based-model:-DisCoCat">Syntax-based model: DisCoCat</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Bag-of-words:-Spiders-reader">Bag-of-words: Spiders reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Word-sequence-models:-Cups-and-stairs-readers">Word-sequence models: Cups and stairs readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Tree-readers">Tree readers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rewrite.html">Step 2. Diagram rewriting</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameterise.html">Step 3. Parameterisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training.html">Step 4: Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Choosing a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual_training.html">Advanced: Manual training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced: DisCoPy usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="extend-lambeq.html">Advanced: Extending lambeq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Toolkit</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../root-api.html">lambeq package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../package-api.html">Subpackages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uml-diagrams.html">Class diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command-line interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://qnlp.cambridgequantum.com/downloads.html">Resources</a></li>
<li class="toctree-l1"><a class="reference external" href="https://qnlp.cambridgequantum.com/generate.html">Web demo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discopy.readthedocs.io">DisCoPy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lambeq</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Step 1. Sentence input</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/CQCL/lambeq/blob/main/docs/tutorials/sentence-input.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Step-1.-Sentence-input">
<h1>Step 1. Sentence input<a class="headerlink" href="#Step-1.-Sentence-input" title="Permalink to this headline"></a></h1>
<p>The first part of the process in <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> given a sentence, is to convert it into a <a class="reference internal" href="../glossary.html#term-string-diagram"><span class="xref std std-term">string diagram</span></a>, according to a given <a class="reference internal" href="../glossary.html#term-compositional-model"><span class="xref std std-term">compositional scheme</span></a>. <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> can accommodate any <a class="reference internal" href="../glossary.html#term-compositional-model"><span class="xref std std-term">compositional model</span></a> that can encode sentences as <a class="reference internal" href="../glossary.html#term-string-diagram"><span class="xref std std-term">string diagrams</span></a>, its native data structure. The toolkit currently includes a number of <a class="reference internal" href="../glossary.html#term-compositional-model"><span class="xref std std-term">compositional models</span></a>, using various degrees of syntactic information: <a class="reference internal" href="../glossary.html#term-bag-of-words"><span class="xref std std-term">bag-of-words</span></a> models do not use any syntactic information, <a class="reference internal" href="../glossary.html#term-word-sequence-model"><span class="xref std std-term">word-sequence models</span></a> respect the order of words, while fully syntax-based models are based on grammatical derivations provided by a parser.</p>
<p><a class="reference download internal" download="" href="../_downloads/5654da6976a7b7b8e5bbe958b8a05822/sentence-input.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">code</span></code></a></p>
<section id="Syntax-based-model:-DisCoCat">
<h2>Syntax-based model: DisCoCat<a class="headerlink" href="#Syntax-based-model:-DisCoCat" title="Permalink to this headline"></a></h2>
<p>In order to obtain a <a class="reference internal" href="../glossary.html#term-DisCoCat"><span class="xref std std-term">DisCoCat</span></a>-like output, we first use the <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.BobcatParser" title="lambeq.text2diagram.BobcatParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">BobcatParser</span></code></a> class from <a class="reference internal" href="../lambeq.text2diagram.html#module-lambeq.text2diagram" title="lambeq.text2diagram"><code class="xref py py-mod docutils literal notranslate"><span class="pre">text2diagram</span></code></a> package, which, in turn,  calls the <a class="reference internal" href="../glossary.html#term-parser"><span class="xref std std-term">parser</span></a>, obtains a <a class="reference internal" href="../glossary.html#term-Combinatory-Categorial-Grammar-CCG"><span class="xref std std-term">CCG</span></a> derivation for the sentence, and converts it into a <a class="reference internal" href="../glossary.html#term-string-diagram"><span class="xref std std-term">string diagram</span></a>. The code below uses the default <a class="reference internal" href="../glossary.html#term-Bobcat"><span class="xref std std-term">Bobcat</span></a> parser in order to produce a <a class="reference internal" href="../glossary.html#term-string-diagram"><span class="xref std std-term">string diagram</span></a> for the sentence “John walks in the park”.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">lambeq</span></code>’s string diagrams are objects of the class <a class="reference external" href="https://discopy.readthedocs.io/en/main/_autosummary/discopy.rigid.Diagram.html#discopy.rigid.Diagram" title="(in discopy)"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.rigid.Diagram</span></code></a>.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq</span> <span class="kn">import</span> <span class="n">BobcatParser</span>
<span class="kn">from</span> <span class="nn">discopy</span> <span class="kn">import</span> <span class="n">grammar</span>

<span class="n">sentence</span> <span class="o">=</span> <span class="s1">&#39;John walks in the park&#39;</span>

<span class="c1"># Parse the sentence and convert it into a string diagram</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">BobcatParser</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;suppress&#39;</span><span class="p">)</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>

<span class="n">grammar</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">diagram</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_sentence-input_4_0.png" src="../_images/tutorials_sentence-input_4_0.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Drawing a pregroup diagram in <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> like the one above can be done using the <a class="reference external" href="https://discopy.readthedocs.io/en/main/_autosummary/discopy.grammar.pregroup.draw.html#discopy.grammar.pregroup.draw" title="(in discopy)"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.grammar.draw()</span></code></a> method.</p>
</div>
<p>Another case of syntax-based models in <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> is <a class="reference internal" href="#sec-tree-readers"><span class="std std-ref">tree readers</span></a>, which will be presented later in this tutorial.</p>
</section>
<section id="Bag-of-words:-Spiders-reader">
<h2>Bag-of-words: Spiders reader<a class="headerlink" href="#Bag-of-words:-Spiders-reader" title="Permalink to this headline"></a></h2>
<p><a class="reference internal" href="../glossary.html#term-DisCoCat"><span class="xref std std-term">DisCoCat</span></a> is not the only <a class="reference internal" href="../glossary.html#term-compositional-model"><span class="xref std std-term">compositional model</span></a> that <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> supports. In fact, any compositional scheme that manifests sentences as <a class="reference internal" href="../glossary.html#term-string-diagram"><span class="xref std std-term">string diagrams</span></a>/<a class="reference internal" href="../glossary.html#term-tensor-network"><span class="xref std std-term">tensor networks</span></a> can be added to the toolkit via the readers of the <a class="reference internal" href="../lambeq.text2diagram.html#module-lambeq.text2diagram" title="lambeq.text2diagram"><code class="xref py py-mod docutils literal notranslate"><span class="pre">text2diagram</span></code></a> package. For example, the <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.spiders_reader" title="lambeq.text2diagram.spiders_reader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spiders_reader</span></code></a> object of the <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.LinearReader" title="lambeq.text2diagram.LinearReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearReader</span></code></a> class represents a sentence as a “<a class="reference internal" href="../glossary.html#term-bag-of-words"><span class="xref std std-term">bag-of-words</span></a>”, composing the words using a <a class="reference internal" href="../glossary.html#term-spider"><span class="xref std std-term">spider</span></a> (a commutative operation).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq</span> <span class="kn">import</span> <span class="n">spiders_reader</span>

<span class="c1"># Create string diagrams based on spiders reader</span>
<span class="n">spiders_diagram</span> <span class="o">=</span> <span class="n">spiders_reader</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>

<span class="c1"># Not a pregroup diagram, we can&#39;t use grammar.draw()</span>
<span class="n">spiders_diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_sentence-input_8_0.png" src="../_images/tutorials_sentence-input_8_0.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that this time the drawing is performed with diagram’s own method <a class="reference external" href="https://discopy.readthedocs.io/en/main/_autosummary/discopy.monoidal.Diagram.html#discopy.monoidal.Diagram.draw" title="(in discopy)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">monoidal.Diagram.draw()</span></code></a>, which renders simple monoidal structures consisting of boxes and wires, instead of the pregroup-specific form we obtained by using <a class="reference external" href="https://discopy.readthedocs.io/en/main/_autosummary/discopy.grammar.pregroup.draw.html#discopy.grammar.pregroup.draw" title="(in discopy)"><code class="xref py py-class docutils literal notranslate"><span class="pre">grammar.draw()</span></code></a> in the previous section, which can only be used in pregroup diagrams.</p>
</div>
</section>
<section id="Word-sequence-models:-Cups-and-stairs-readers">
<h2>Word-sequence models: Cups and stairs readers<a class="headerlink" href="#Word-sequence-models:-Cups-and-stairs-readers" title="Permalink to this headline"></a></h2>
<p>The <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.LinearReader" title="lambeq.text2diagram.LinearReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearReader</span></code></a> class can be used to create any kind of model where words are composed in sequence, from left to right. For example, the <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.cups_reader" title="lambeq.text2diagram.cups_reader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cups_reader</span></code></a> instance of this class generates a “<a class="reference internal" href="../glossary.html#term-tensor-train"><span class="xref std std-term">tensor train</span></a>”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq</span> <span class="kn">import</span> <span class="n">cups_reader</span>

<span class="c1"># Create string diagrams based on cups reader</span>
<span class="n">cups_diagram</span> <span class="o">=</span> <span class="n">cups_reader</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>

<span class="n">grammar</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cups_diagram</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_sentence-input_12_0.png" src="../_images/tutorials_sentence-input_12_0.png" />
</div>
</div>
<p>Note the use of a <code class="docutils literal notranslate"><span class="pre">START</span></code> symbol in the beginning of the sentence, represented as an order-1 tensor (a vector). This ensures that the final result of the computation (that is, the representation of the sentence) will be again a tensor of order 1.</p>
<p>Another pre-made word-sequence model is provided by the <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.stairs_reader" title="lambeq.text2diagram.stairs_reader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stairs_reader</span></code></a> instance. This model combines consecutive words using a box (“cell”) in a recurrent fashion, similarly to a recurrent neural network.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq</span> <span class="kn">import</span> <span class="n">stairs_reader</span>

<span class="n">stairs_diagram</span> <span class="o">=</span> <span class="n">stairs_reader</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="n">stairs_diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_sentence-input_15_0.png" src="../_images/tutorials_sentence-input_15_0.png" />
</div>
</div>
<span class="target" id="sec-tree-readers"></span></section>
<section id="Tree-readers">
<h2>Tree readers<a class="headerlink" href="#Tree-readers" title="Permalink to this headline"></a></h2>
<p>A <a class="reference internal" href="../glossary.html#term-Combinatory-Categorial-Grammar-CCG"><span class="xref std std-term">CCG</span></a> derivation follows a biclosed form <a class="reference internal" href="../bibliography.html#yk2021" id="id1"><span>[YK2021]</span></a> , which can be directly interpreted as a series of compositions without any explicit conversion into a <a class="reference internal" href="../glossary.html#term-pregroup-grammar"><span class="xref std std-term">pregroup</span></a> form. Class <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.TreeReader" title="lambeq.text2diagram.TreeReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeReader</span></code></a> implements a number of compositional models by taking advantage of this fact. In order to demonstrate the way they work, it would be useful to first examine how a CCG diagram looks like:</p>
<center><p><img alt="7a088cb7850947c194a5fba1840b2dfc" class="no-scaled-link" src="../_images/ccg-diagram.png" style="width: 350px;" /></p>
</center><p>Even without knowing the specifics of CCG syntax, it is not difficult to see that the verb “gave” is first composed with the indirect object “Mary”, then the result is composed with the noun phrase “a flower” which correspond to the direct object, and finally the entire verb phrase “gave Mary a flower” is further composed with the subject “John” to return a sentence. A <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.TreeReader" title="lambeq.text2diagram.TreeReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeReader</span></code></a> follows this order of composition, as demonstrated below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq</span> <span class="kn">import</span> <span class="n">TreeReader</span>

<span class="n">reader</span> <span class="o">=</span> <span class="n">TreeReader</span><span class="p">()</span>
<span class="n">sentence</span> <span class="o">=</span> <span class="s2">&quot;John gave Mary a flower&quot;</span>

<span class="n">tree_diagram</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="n">tree_diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_sentence-input_21_0.png" src="../_images/tutorials_sentence-input_21_0.png" />
</div>
</div>
<p>Note that in this default call, composition is handled by a single “cell” named <code class="docutils literal notranslate"><span class="pre">UNIBOX</span></code>. This can be changed by passing an explicit argument of type <a class="reference internal" href="../lambeq.text2diagram.html#lambeq.text2diagram.TreeReaderMode" title="lambeq.text2diagram.TreeReaderMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeReaderMode</span></code></a> to the reader’s constructor. There are three possible choices:</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">NO_TYPE</span></code> is the default, where all compositions are handled by the same <code class="docutils literal notranslate"><span class="pre">UNIBOX</span></code> cell (above diagram).</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RULE_ONLY</span></code> creates a different cell for each CCG rule.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RULE_TYPE</span></code> creates a different cell for each (rule, type) pair.</p></li>
</ul>
<p>For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq</span> <span class="kn">import</span> <span class="n">TreeReader</span><span class="p">,</span> <span class="n">TreeReaderMode</span>

<span class="n">reader</span> <span class="o">=</span> <span class="n">TreeReader</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">TreeReaderMode</span><span class="o">.</span><span class="n">RULE_ONLY</span><span class="p">)</span>
<span class="n">sentence</span> <span class="o">=</span> <span class="s2">&quot;John gave Mary a flower&quot;</span>

<span class="n">tree_diagram</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="n">tree_diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_sentence-input_23_0.png" src="../_images/tutorials_sentence-input_23_0.png" />
</div>
</div>
<p>In the above, each unique CCG rule gets its own box: FA boxes correspond to forward application, and BA boxes to backward application. For certain tasks, making the composition box rule-specific might lead to better generalisation and overall performance.</p>
<p class="rubric">See also:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../package-api.html#api-text2diagram"><span class="std std-ref">lambeq.text2diagram package</span></a></p></li>
<li><p><a class="reference internal" href="../examples/parser.html"><span class="doc">Example notebook parser.ipynb</span></a></p></li>
<li><p><a class="reference internal" href="../examples/reader.html"><span class="doc">Example notebook reader.ipynb</span></a></p></li>
<li><p><a class="reference internal" href="../examples/tree_reader.html"><span class="doc">Example notebook tree_reader.ipynb</span></a></p></li>
<li><p><a class="reference internal" href="discocat.html"><span class="doc">DisCoCat in DisCoPy</span></a></p></li>
<li><p><a class="reference internal" href="extend-lambeq.html"><span class="doc">Extending lambeq</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../CONTRIBUTING.html" class="btn btn-neutral float-left" title="Contributing to lambeq" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rewrite.html" class="btn btn-neutral float-right" title="Step 2. Diagram rewriting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022 Cambridge Quantum Computing Ltd..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>