<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>String diagrams &mdash; lambeq 0.3.1 [git latest] documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/table-wrap.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="DisCoPy" href="discopy.html" />
    <link rel="prev" title="Syntactic parsing" href="parsing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            lambeq
              <img src="_static/lambeq_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.3.1 [git latest]
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsing.html">Syntactic parsing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">String diagrams</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#motivation-and-connection-to-tensor-networks">Motivation and connection to tensor networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pregroup-grammars">Pregroup grammars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="discopy.html">DisCoPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="use-cases.html">lambeq use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing to lambeq</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NLP-101</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nlp-intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp-data.html">Working with text data</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp-class.html">Text classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp-ml.html">Machine learning best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp-refs.html">References for further study</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/sentence-input.html">Step 1. Sentence input</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/rewrite.html">Step 2. Diagram rewriting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/parameterise.html">Step 3. Parameterisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Step 4: Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Choosing a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_training.html">Advanced: Manual training</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced: DisCoPy usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/extend-lambeq.html">Advanced: Extending lambeq</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Toolkit</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="root-api.html">lambeq package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package-api.html">Subpackages</a></li>
<li class="toctree-l1"><a class="reference internal" href="uml-diagrams.html">Class diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-line interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://qnlp.cambridgequantum.com/downloads.html">Resources</a></li>
<li class="toctree-l1"><a class="reference external" href="https://qnlp.cambridgequantum.com/generate.html">Web demo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discopy.readthedocs.io">DisCoPy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lambeq</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">String diagrams</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/CQCL/lambeq/blob/main/docs/string_diagrams.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="string-diagrams">
<span id="sec-string-diagrams"></span><h1>String diagrams<a class="headerlink" href="#string-diagrams" title="Permalink to this heading"></a></h1>
<section id="motivation-and-connection-to-tensor-networks">
<h2>Motivation and connection to tensor networks<a class="headerlink" href="#motivation-and-connection-to-tensor-networks" title="Permalink to this heading"></a></h2>
<p>“Programming” a quantum computer requires from developers the ability to manipulate <a class="reference internal" href="glossary.html#term-quantum-gate"><span class="xref std std-term">quantum gates</span></a> (which can be seen as the “atomic” units of computation in this paradigm) in order to create <a class="reference internal" href="glossary.html#term-quantum-circuit"><span class="xref std std-term">quantum circuits</span></a>, which can be further grouped into higher-order constructions. Working at such a low level compares to writing assembly in a classical computer, and is extremely hard for humans – especially on <a class="reference internal" href="glossary.html#term-natural-language-processing-NLP"><span class="xref std std-term">NLP</span></a> tasks which contain many levels of abstractions.</p>
<p>In order to simplify <a class="reference internal" href="glossary.html#term-natural-language-processing-NLP"><span class="xref std std-term">NLP</span></a> design on quantum hardware, <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> represents sentences as <a class="reference internal" href="glossary.html#term-string-diagram"><span class="xref std std-term">string diagrams</span></a> (<a class="reference internal" href="#fig-stringdiagram"><span class="std std-numref">Fig. 3</span></a>). This choice stems from the fact that a <a class="reference internal" href="glossary.html#term-string-diagram"><span class="xref std std-term">string diagram</span></a> expresses computations in a <a class="reference internal" href="tutorials/monoidal.html#Monoidal-categories"><span class="std std-ref">monoidal category</span></a>, an abstraction well-suited to model the way a quantum computer works and processes data.</p>
<p>From a more practical point of view, a <a class="reference internal" href="glossary.html#term-string-diagram"><span class="xref std std-term">string diagram</span></a> can be seen as an enriched <a class="reference internal" href="glossary.html#term-tensor-network"><span class="xref std std-term">tensor network</span></a>, a mathematical structure with many applications in quantum physics. Compared to tensor networks, string diagrams have some additional convenient properties, for example, they respect the order of words, and allow easy rewriting/modification of their structure.</p>
<figure class="align-center" id="id2">
<span id="fig-stringdiagram"></span><img alt="_images/string_diagram.png" src="_images/string_diagram.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">String diagram (a) and corresponding tensor network (b).</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="glossary.html#term-string-diagram"><span class="xref std std-term">String diagrams</span></a> and <a class="reference internal" href="glossary.html#term-tensor-network"><span class="xref std std-term">tensor networks</span></a> constitute an ideal abstract representation of the compositional relations between the words in a sentence, in the sense that they remain close to <a class="reference internal" href="glossary.html#term-quantum-circuit"><span class="xref std std-term">quantum circuits</span></a>, yet are independent of any low-level decisions (such as choice of <a class="reference internal" href="glossary.html#term-quantum-gate"><span class="xref std std-term">quantum gates</span></a> and construction of circuits representing words and sentences) that might vary depending on design choices and the type of quantum hardware that the experiment is running on.</p>
</section>
<section id="pregroup-grammars">
<span id="sec-pregroup-grammars"></span><h2>Pregroup grammars<a class="headerlink" href="#pregroup-grammars" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">lambeq</span></code>’s string diagrams are equipped with types, which show the interactions between the words in a sentence according to the <a class="reference internal" href="glossary.html#term-pregroup-grammar"><span class="xref std std-term">pregroup grammar</span></a> formalism <a class="reference internal" href="bibliography.html#lam1999" id="id1"><span>[Lam1999]</span></a>. In a pregroup grammar, each type <span class="math notranslate nohighlight">\(p\)</span> has a left (<span class="math notranslate nohighlight">\(p^l\)</span>) and a right (<span class="math notranslate nohighlight">\(p^r\)</span>) <a class="reference internal" href="glossary.html#term-adjoint"><span class="xref std std-term">adjoint</span></a>, for which the following hold:</p>
<div class="math notranslate nohighlight">
\[p^l \cdot p \to 1 \to p \cdot p^l~~~~~~~~~~~~~
p \cdot p^r \to 1 \to p^r \cdot p\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> and <a class="reference internal" href="glossary.html#term-DisCoPy"><span class="xref std std-term">DisCoPy</span></a>, the adjoints of a type <code class="docutils literal notranslate"><span class="pre">p</span></code> are represented as <code class="docutils literal notranslate"><span class="pre">p.l</span></code> and <code class="docutils literal notranslate"><span class="pre">p.r</span></code>, while the tensor product is the symbol <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>.</p>
</div>
<p>When annotated with pregroup types, the diagram in <a class="reference internal" href="#fig-stringdiagram"><span class="std std-numref">Fig. 3</span></a> takes the following form:</p>
<a class="reference internal image-reference" href="_images/pregroups.png"><img alt="_images/pregroups.png" class="align-center" src="_images/pregroups.png" style="width: 387.84000000000003px; height: 129.28px;" /></a>
<p>Note that each wire in the sentence is labelled with an atomic type or an <a class="reference internal" href="glossary.html#term-adjoint"><span class="xref std std-term">adjoint</span></a>. In the above, <span class="math notranslate nohighlight">\(n\)</span> corresponds to a noun or a noun phrase, and <span class="math notranslate nohighlight">\(s\)</span> to a sentence. The adjoints <span class="math notranslate nohighlight">\(n^r\)</span> and <span class="math notranslate nohighlight">\(n^l\)</span> indicate that a noun is expected on the left or the right of the specific word, respectively. Thus, the composite type <span class="math notranslate nohighlight">\(n \cdot n^l\)</span> of the determiner “a” means that it is a word that expects a noun on its right in order to return a noun phrase.</p>
<p>The transition from pregroups to vector space semantics is achieved by a mapping that sends atomic types to vector spaces (<span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(s\)</span> to <span class="math notranslate nohighlight">\(S\)</span>) and composite types to tensor product spaces (e.g. <span class="math notranslate nohighlight">\(n^r \cdot s \cdot n^l \cdot n^l\)</span> to <span class="math notranslate nohighlight">\(N \otimes S \otimes N \otimes N\)</span>). Therefore, each word can be seen as a specific state in the corresponding space defined by its grammatical type, i.e. a tensor, the order of which is determined by the number of wires emanating from the corresponding box. The <a class="reference internal" href="glossary.html#term-cup"><span class="xref std std-term">cups</span></a> denote tensor contractions. A concrete instantiation of the diagram requires the assignment of dimensions (which in the quantum case amounts to fixing the number of <a class="reference internal" href="glossary.html#term-qubit"><span class="xref std std-term">qubits</span></a>) for each vector space corresponding to an atomic type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">lambeq</span></code>’s string diagrams are objects of the class <code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.grammar.pregroup.Diagram</span></code>.</p>
</div>
<p class="rubric">See also:</p>
<ul class="simple">
<li><p><a class="reference internal" href="tutorials/discocat.html#Pregroup-grammars"><span class="std std-ref">Pregroup grammars in DisCoPy</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parsing.html" class="btn btn-neutral float-left" title="Syntactic parsing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="discopy.html" class="btn btn-neutral float-right" title="DisCoPy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023 Cambridge Quantum Computing Ltd..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>