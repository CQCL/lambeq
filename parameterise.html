

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Step 3: Parameterisation &mdash; lambeq 0.1.3.dev4+gc7bccba documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Step 4. Training" href="training.html" />
    <link rel="prev" title="Step 2: Diagram rewriting" href="rewrite.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> lambeq
          

          
            
            <img src="_static/lambeq_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.3.dev4+gc7bccba
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsing.html">Syntactic parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="string_diagrams.html">String diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="discopy.html">DisCoPy</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sentence_input.html">Step 1: Sentence input</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewrite.html">Step 2: Diagram rewriting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Step 3: Parameterisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quantum-case">Quantum case</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classical-case">Classical case</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#matrix-product-states">Matrix product states</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Step 4. Training</a></li>
</ul>
<p class="caption"><span class="caption-text">Toolkit</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://qnlp.cambridgequantum.com/downloads.html">Resources</a></li>
<li class="toctree-l1"><a class="reference external" href="https://qnlp.cambridgequantum.com/generate.html">Web demo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discopy.readthedocs.io">DisCoPy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lambeq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Step 3: Parameterisation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/CQCL/lambeq/blob/main/docs/parameterise.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="step-3-parameterisation">
<span id="sec-parameterise"></span><h1>Step 3: Parameterisation<a class="headerlink" href="#step-3-parameterisation" title="Permalink to this headline">¶</a></h1>
<p>Up to this point of the pipeline, a sentence is still represented as a string diagram, independent of any low-level decisions such as tensor dimensions or specific quantum gate choices. This abstract form can be turned into a concrete quantum circuit or tensor network by applying ansätze. An <em>ansatz</em> can be seen as a map that determines choices such as the number of qubits that every wire of the string diagram is associated with and the concrete parameterised quantum states that correspond to each word. In <code class="docutils literal notranslate"><span class="pre">lambeq</span></code>, ansätze can be added by extending one of the classes <a class="reference internal" href="lambeq.html#lambeq.tensor.TensorAnsatz" title="lambeq.tensor.TensorAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorAnsatz</span></code></a> or <a class="reference internal" href="lambeq.html#lambeq.circuit.CircuitAnsatz" title="lambeq.circuit.CircuitAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">CircuitAnsatz</span></code></a>, depending on the type of the experiment.</p>
<div class="section" id="quantum-case">
<h2>Quantum case<a class="headerlink" href="#quantum-case" title="Permalink to this headline">¶</a></h2>
<p>For the quantum case, the library comes equipped with the class <a class="reference internal" href="lambeq.html#lambeq.circuit.IQPAnsatz" title="lambeq.circuit.IQPAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">IQPAnsatz</span></code></a>, which turns the string diagram into a standard IQP circuit <a class="footnote-reference brackets" href="#f1" id="id1">1</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq.ccg2discocat</span> <span class="kn">import</span> <span class="n">DepCCGParser</span>

<span class="n">sentence</span> <span class="o">=</span> <span class="s1">&#39;John walks in the park&#39;</span>

<span class="c1"># Get a string diagram</span>
<span class="n">depccg_parser</span> <span class="o">=</span> <span class="n">DepCCGParser</span><span class="p">()</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">depccg_parser</span><span class="o">.</span><span class="n">sentence2diagram</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to create an <a class="reference internal" href="lambeq.html#lambeq.circuit.IQPAnsatz" title="lambeq.circuit.IQPAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">IQPAnsatz</span></code></a> instance, we need to define the number of qubits for all atomic types that occur in the diagram – in this case, for the noun type and the sentence type. The following code produces a circuit by assigning 1 qubit to the noun type and 1 qubit to the sentence type. Further, the number of IQP layers (<code class="docutils literal notranslate"><span class="pre">n_layers</span></code>) is set to 1.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq.circuit</span> <span class="kn">import</span> <span class="n">IQPAnsatz</span>
<span class="kn">from</span> <span class="nn">lambeq.core.types</span> <span class="kn">import</span> <span class="n">AtomicType</span>

<span class="c1"># Define atomic types</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">AtomicType</span><span class="o">.</span><span class="n">NOUN</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">AtomicType</span><span class="o">.</span><span class="n">SENTENCE</span>

<span class="c1"># Convert string diagram to quantum circuit</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">IQPAnsatz</span><span class="p">({</span><span class="n">N</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">discopy_circuit</span> <span class="o">=</span> <span class="n">ansatz</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
<span class="n">discopy_circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>This produces a quantum circuit in <code class="docutils literal notranslate"><span class="pre">discopy</span></code> form:</p>
<img alt="_images/circuit.png" src="_images/circuit.png" />
<p>Conversion to <code class="docutils literal notranslate"><span class="pre">pytket</span></code> format is very simple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to pytket form</span>
<span class="n">tket_circuit</span> <span class="o">=</span> <span class="n">discopy_circuit</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
</pre></div>
</div>
<p>Exporting to <code class="docutils literal notranslate"><span class="pre">pytket</span></code> format provides additional functionality and allows interoperability. For example, obtaining a <code class="docutils literal notranslate"><span class="pre">qiskit</span></code> circuit is trivial:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytket.extensions.qiskit</span> <span class="kn">import</span> <span class="n">tk_to_qiskit</span>

<span class="n">qiskit_circuit</span> <span class="o">=</span> <span class="n">tk_to_qiskit</span><span class="p">(</span><span class="n">tket_circuit</span><span class="p">)</span>
<span class="n">qiskit_circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/qiskit-circuit.png" src="_images/qiskit-circuit.png" />
</div>
<div class="section" id="classical-case">
<h2>Classical case<a class="headerlink" href="#classical-case" title="Permalink to this headline">¶</a></h2>
<p>In the case of a classical experiment, instantiating one of the tensor ansätze requires the user to assign dimensions to each one of the atomic types occurring in the diagram. In the following code, we parameterise a <a class="reference internal" href="lambeq.html#lambeq.tensor.TensorAnsatz" title="lambeq.tensor.TensorAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorAnsatz</span></code></a> instance with <span class="math notranslate nohighlight">\(d_n=4\)</span> for the base dimension of the noun space, and <span class="math notranslate nohighlight">\(d_s=2\)</span> as the dimension of the sentence space:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq.tensor</span> <span class="kn">import</span> <span class="n">TensorAnsatz</span>
<span class="kn">from</span> <span class="nn">discopy</span> <span class="kn">import</span> <span class="n">Dim</span>

<span class="n">tensor_ansatz</span> <span class="o">=</span> <span class="n">TensorAnsatz</span><span class="p">({</span><span class="n">N</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">S</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">)})</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">tensor_ansatz</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
</pre></div>
</div>
<p>This produces the following string diagram/tensor network:</p>
<img alt="_images/tensor_ansatz.png" src="_images/tensor_ansatz.png" />
<p>Note that the wires of the diagram are now annotated with the dimensions corresponding to each type, indicating that the result is a concrete tensor network.</p>
<div class="section" id="matrix-product-states">
<h3>Matrix product states<a class="headerlink" href="#matrix-product-states" title="Permalink to this headline">¶</a></h3>
<p>In classical experiments of this kind, the tensors associated with certain words, such as conjunctions, can become extremely large. In some cases, the order of these tensors can be 12 or even higher (<span class="math notranslate nohighlight">\(d^{12}\)</span> elements, where <span class="math notranslate nohighlight">\(d\)</span> is the base dimension), which makes efficient execution of the experiment impossible. In order to address this problem, <code class="docutils literal notranslate"><span class="pre">lambeq</span></code> includes ansätze for converting tensors into various forms of <em>matrix product states</em> (MPSs).</p>
<p>The following code applies the <a class="reference internal" href="lambeq.html#lambeq.tensor.SpiderAnsatz" title="lambeq.tensor.SpiderAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpiderAnsatz</span></code></a> class, which splits tensors with order greater than 2 to sequences of order-2 tensors (i.e. matrices), connected with spiders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq.tensor</span> <span class="kn">import</span> <span class="n">SpiderAnsatz</span>

<span class="n">spider_ansatz</span> <span class="o">=</span> <span class="n">SpiderAnsatz</span><span class="p">({</span><span class="n">N</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">S</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">)})</span>
<span class="n">spider_diagram</span> <span class="o">=</span> <span class="n">spider_ansatz</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
<span class="n">spider_diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<p>The result is the following:</p>
<img alt="_images/spider_ansatz.png" src="_images/spider_ansatz.png" />
<p>Note that the preposition “in” is now represented by a matrix product state of 4 linked matrices, which is a very substantial reduction in the space required to store the tensors.</p>
<p>Another option is the <a class="reference internal" href="lambeq.html#lambeq.tensor.MPSAnsatz" title="lambeq.tensor.MPSAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSAnsatz</span></code></a> class, which converts large tensors to sequences of order-3 tensors connected with cups. In this setting, the user needs to also define the <em>bond dimension</em>, that is, the dimensionality of the wire that connects the tensors together.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lambeq.tensor</span> <span class="kn">import</span> <span class="n">MPSAnsatz</span>

<span class="n">mps_ansatz</span> <span class="o">=</span> <span class="n">MPSAnsatz</span><span class="p">({</span><span class="n">N</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">S</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">)},</span> <span class="n">bond_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mps_diagram</span> <span class="o">=</span> <span class="n">mps_ansatz</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
<span class="n">mps_diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/mps_ansatz.png" src="_images/mps_ansatz.png" />
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><em>Instantaneous Quantum Polynomial</em> – a circuit which interleaves layers of Hadamard gates with diagonal unitaries.</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="training.html" class="btn btn-neutral float-right" title="Step 4. Training" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="rewrite.html" class="btn btn-neutral float-left" title="Step 2: Diagram rewriting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Cambridge Quantum Computing Ltd..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>