{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Step 2. Diagram rewriting"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Syntactic derivations in pregroup form can become extremely complicated, which may lead to excessive use of hardware resources and prohibitively long training times. The purpose of the :py:mod:`~lambeq.rewrite` module is to provide a means to the user to address some of these problems, via :term:`rewriting rules <rewrite rule>` that simplify the :term:`string diagram`. As an example, consider again the sentence \"John walks in the park\".\n",
   "\n",
   ":download:`Download code <../_code/rewrite.ipynb>`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAyYAAAF2CAYAAACbJozsAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAiqUlEQVR4nO3de7SdZX0v+u8PQliB3LhIQOWyRRHB2jZqK4oVubkFLR2op9RLpYgwhgOpOET2sS3uUTkc78daiuLh0FrGOS1bj8dWaLsJAQsW3YIcrYDHiiEBESKCSQhkAYHn/LEmIQlJyGWt9azL5zPGM+blfedc3zmZk7zf+bzzndVaCwAAQE879Q4AAACgmAAAAN0pJgAAQHeKCQAA0J1iAgAAdKeYAAAA3SkmAABAd4oJAADQnWICAAB0p5gAAADdKSYAAEB3igkAANCdYgIAAHSnmAAAAN0pJgAAQHeKCQAA0J1iAgAAdKeYAAAA3SkmAABAd4oJAADQnWICAAB0p5gAAADdKSYAAEB3igkAANCdYgIAAHSnmAAAAN0pJgAAQHeKCQAA0J1iAgAAdKeYAAAA3SkmAABAd4oJAADQnWICAAB0p5gAAADdKSYAAEB3igkAANDdjN4BtsWsWbPuGx4eXtA7x9DQ0PI1a9bs2zsHAABMFZNqxmR4eHhBay3bM+68884kyd13371dt19/TIRyBAAAU8mkKiabctRRR+WCCy7oHQMAANgBk76YAAAAk9+UKib//u//nqOPPjp77LFHXvCCF+SCCy7IE088scE61113XQ477LDMmTMnxx9/fO699951yw466KBceOGFOeaYYzJ79uy89KUvzY033jjeDwMAAKadKVNMVq5cmeOOOy6vf/3rc9999+Wqq67KZZddls9+9rMbrHfFFVfk+uuvzz333JOHH344559//gbLL7vssnz+859fd3/vfve7x/NhAADAtDRlislVV12VmTNn5k//9E+z66675iUveUnOO++8XHrppRus99GPfjR777135s6dm7e//e25+eabN1h+5pln5vDDD8/OO++c008/PXfccUdWrlw5ng8FAACmnSlTTO6+++4ceOCBqap11x188MG5++67N1hvv/32W3d+9913z0MPPbTF5UmesQ4AADC6pkwx2X///bNs2bK01tZdt2TJkuy///4dUwEAAFtjyhSTE088MY8++mguvPDCPPbYY/nxj3+cT3ziE3nPe97TOxoAAPAspkQxqarMmzcvV199da655posWLAgb3jDG/KHf/iH+eAHP9g7HgAA8Cxq/V2fJrqqahvnXbhwYc4888yceeaZ45kjrbV69jUBAICtMalnTL7//e/n1ltvzate9areUQAAgB0wo3eA7XXKKafkW9/6Vi688ML8+q//eu84AADADpj0u3J1ymFXLgAAGEWTasZkaGhoeVUtmAg5emcAAICpZFLNmOyoqjo0yddba4f2zgIAADxtUn/5HQAAmBoUEwAAoDvFBAAA6E4xAQAAulNMAACA7hSTjVTV0qr6SFUtrqrVVXVrVb26dy4AAJjKFJNNOy3J2UnmJVmU5Mt94wAAwNSmmGzaJa2121prTyS5NMkLq2pe71AAADBVKSabdu965x8enM7pEQQAAKYDxQQAAOhOMQEAALpTTAAAgO5m9A4w0bTWDtro8tIk1SUMAABME2ZMAACA7syYTHKzZs26b3h4eEHvHDzT0NDQ8jVr1uzbOwcAwGSgmExyw8PDC1prvWOMim9+85s59thjs3bt2iTJqaeemhkzZuTSSy/tnGz7VJXCCACwlezKBQAAdKeYAAAA3Skm7LCvfe1rOeSQQ9ZdPv/881NVWbJkSZLku9/9bubNm5dVq1bl5JNPzr777pu5c+dm4cKFWbRo0Vb/nQsuuCCHHHJIfvKTn+TRRx/NGWeckX322Sdz587Ni170onzlK18Z9ccGAMD4UEzYYUcffXSWLFmSu+66K0myaNGivPCFL8w111yz7vLrXve67LTTTjn55JPzk5/8JA888ED+4A/+IG95y1ty//33b/H+H3/88Zx22mn5p3/6p9x444150YtelC9/+cu56aab8qMf/SirVq3Ktddem8MPP3zMHysAAGNDMWGHzZ8/PwsXLsw111yTVatW5bbbbsuf/MmfrJsNueaaa3Lsscdm9uzZeec735k5c+Zkl112ybnnnpuZM2fmpptu2ux9r1y5Mm984xvXlY+99947STJz5sysXr06t99+e9auXZv9998/hx122Lg8XgAARp9iwqg49thjc8011+S6667LEUcckRNOOCHXXXddVq9enW9/+9s59thjs2bNmpx11ll5wQtekLlz52b+/Pn51a9+tcUZkxtuuCH/9m//lo997GMZGhpad/073/nOnH766TnnnHOy11575eSTT84dd9wxHg8VAIAxoJgwKo499thce+21WbRoUY477rjss88+ed7znpfPfe5z2WuvvXLYYYfls5/9bK6//vosXrw4K1euzIoVK7LHHntkS4c7ftOb3pRPfvKTef3rX58f/OAH666fMWNGzjvvvNx8881ZtmxZdtttt5x22mnj8VABABgDfseEUfGa17wmq1atyuWXX57rr78+SXLMMcfkU5/6VE466aQkyapVq7Lrrrtmr732ymOPPZZPfOITWbFixbPe9/vf//7Mnj07xxxzTL7xjW/kiCOOyLXXXpt58+blZS97WWbNmpXdd989O++881g+RAAAxpAZE0bFrrvumiOPPDJDQ0N52ctelmRkFmXVqlU59thjkyQf/OAHM3/+/Dz3uc/NwQcfnN122y0HHXTQVt3/H/3RH+ULX/hCTjzxxCxevDjLly/Pu971ruyxxx7Zb7/9smzZsnzpS18aq4cHAMAYq6nyq+Fbo6oOTfL11tqhvbOMlqpq0+m/4WRSVWmtVe8cAACTgRkTAACgO8UEAADoTjEBAAC6c1SuSW5oaGh5VS3onYNnGhoaWt47AwDAZKGYTHJr1qzZd0duX1UXJ7m1tXbxKEWa1KpqRpLh1pr3BgDAOLIrFwAA0J1iAgAAdKeYAAAA3SkmjKmq2qV3BgAAJj7FhGdVVUur6iNVtbiqVlfVrVX16s2s+1+r6tqq+nRVLU/yj+Mcd1xU1dlVdWdVPVRV91TVhb0zAQBMZo48xNY6LclJSf6/JJ9O8uUkL9rMur+T5Kok+2cKvsaq6pAkH0/yytbabVU1P8mhfVMBAExuZkzYWpe01m5rrT2R5NIkL6yqeZtZd1lr7TOttcdaa4+MY8bxsjZJJTm8qma31la01r7TOxQAwGSmmLC17l3v/MOD0zmbWXfZGGfpqrW2JMk7krw3yc+r6ltVdXznWAAAk5piwlh4sneAsdZa+1pr7bgkeyf5b0n+oap26xwLAGDSUkxgG1XVi6vqPw+KyONJViZpmQaFDABgrCgm7JCqekdVre6dY5zNTHJ+RnZvW5Hk7CRvaa0N9wwFADCZVWutd4ZxU1WHJvl6a80RlAaq6uIkt7bWLu6dZSKoqhlJhltrU+5oYgAAE5kZEwAAoDufCsMUN2vWrPuGh4cX9M4BsKOGhoaWr1mzZt/eOYCxoZjAFDc8PLxgOu2yCUxdVeVDFpjC7MoFwDZ54xvfmE9+8pO9YwAwxZgxAWCb/PM//3PvCABMQWZMAACA7hQTALbJUUcdlQsuuCBLly5NVeXyyy/PYYcdljlz5uT444/Pvffe2zsiAJOQYgLADrniiity/fXX55577snDDz+c888/v3ckACYhxQSAHfLRj340e++9d+bOnZu3v/3tufnmm3tHAmASUkwA2CH77bffuvO77757HnrooY5pAJisFBMAAKA7xQQAAOhOMQEAALqr1lrvDOOmqg5N8vXW2qG9s0wUVXVxkltbaxf3zjIRVNWMJMOttSnz46NV1abT+xyYuqoqrbXqnQMYG2ZMAACA7hQTAACgO8UEAADobsrsRw9s2tDQ0PKqWtA7B8COGhoaWt47AzB2FBOY4tasWbPvjty+qs5JckBr7ZxRijTpVdWdSY5urd3ZO8tEUFVvTnJGa+3NvbNMFFW1KMknW2uLemeZCBx8BtgaduUCAAC6U0wAgEmlqk6tqjt65wBGl2ICAAB0p5gA3dQI33XbSFXtsiPLp5rp9ngBpivFBBgVVXV2Vd1ZVQ9V1T1VdeFm1mtV9cdVdXOSR5K8YnyTjo+qWlpVH6mqxVW1uqpurapXb2bd/1pV11bVp6tqeZJ/3Gj5UVW1tqreVVVLkjw4Ho9hNI3m8zFVbO17ZrrYltcIMDUpJsAOq6pDknw8yZtaa3OSHJ4tb0y+J8nvJ5md5P8d+4TdnJbk7CTzkixK8uUtrPs7Se5Nsn+St2xi+c5JTkjym0km6+GfR/P5mNS24z0zXWzLawSYYhQTYDSsTVJJDq+q2a21Fa2172xh/U+31n7aWnuitfboOGXs4ZLW2m2ttSeSXJrkhVU1bzPrLmutfaa19lhr7ZHNrHNea23lFpZPdKP9fExm2/qemS625TUCTDGKCbDDWmtLkrwjyXuT/LyqvlVVx2/hJkvHJVh/9653/uHB6ZzNrLvsWe7rySR373Civkbz+ZjUtuM9M11sy2sEmGIUE2BUtNa+1lo7LsneSf5bkn+oqt02s/qT45ds0ni256S11tq4JJkYpvxrZBvfMwBTnmIC7LCqenFV/efBRtXjSVYmaZkGG5ewPbxnAJ5JMQFGw8wk52dkN4wVGfny6ltaa8NVdVtVfaRnuImmqt5RVau3sPyAwVGJXjueuXp5tudjitrse6ZnqIlqmr5GYNqp6bRnQFUdmuTrrbVDe2eZKKrq4iS3ttYu7p1lIhj8psZwa81vawxU1TlJDmitndM7y0RRVXcmObq1dmfvLBNBVb05yRmttTf3zjJRVNWiJJ9srS3qnWUi8O8vsDXMmAAAAN35VBgAYBvNmjXrvuHh4cn6m0JT2tDQ0PI1a9bs2zsH204xAQDYRsPDwwum0+7wk0lVKYyTlF25AACmiVNPPTWnn3567xiwSYoJAMAUddRRR+WCCy7oHQO2imICAAB0p5gAAExBZ511Vm644YZ87GMfy+zZs/PiF784SfLoo4/mve99b+bPn5/nPe95ueSSSza43Q033JAjjzwye+65Zw4++OB85jOfie/TMB4UEwCAKeiiiy7Ka1/72vzZn/1ZVq9enR//+MdJkq9+9at585vfnAcffDB/+Zd/mbPOOivLli1Lktx+++054YQTcu655+b+++/PVVddlYsuuiiXX355z4fCNKGYAABMI0cffXR+93d/NzvttFNOPvnkzJ8/P9///veTJBdffHHe9ra35aSTTsrOO++cQw89NGeddVb+9m//tm9opgWHCwYAmEb222+/DS7vvvvueeihh5Ikd955Z6699tp87WtfW7f8ySefzP777z+uGZmezJgAAExRO+20bZt6Bx54YE477bSsWLFi3Vi1alVuu+22MUoIT1NMAACmqH333Td33HHHVq//vve9L3//93+fb3zjG3n88cezdu3a3H777fnXf/3XMUwJIxQTAIAp6pxzzsnNN9+c+fPn5/DDD3/W9V/60pfmyiuvzOc+97nst99+2WeffXLqqafm/vvvH4e0THe+YwIAMEW98pWvzK233rrFdZYuXbrB5SOOOCKLFy8ew1SwaWZMAACA7hQTAACgO7tyAQBso6GhoeVVtaB3Dp5paGhoee8MbB/FBABgG61Zs2bfHbl9VV2c5NbW2sWjFGlSq6oZSYZba7ZNpzG7cgEAAN0pJgAAQHeKCQAAU0pVnVpVW//LkkwIigkAANCdYgIAAHSnmAAATEBVtbSqPlJVi6tqdVXdWlWv7p2rF8/H1KeYAABMXKclOTvJvCSLkny5b5zuPB9TmGICADBxXdJau6219kSSS5O8sKrm9Q7VkedjClNMAAAmrnvXO//w4HROjyAThOdjClNMAACA7hQTAACg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\n",
      "text/plain": [
       "<Figure size 792x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from lambeq import BobcatParser\n",
    "\n",
    "# Parse the sentence\n",
    "parser = BobcatParser(verbose='suppress')\n",
    "diagram = parser.sentence2diagram(\"John walks in the park\")\n",
    "\n",
    "diagram.draw(figsize=(11,5), fontsize=13)"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Note that the representation of the preposition is a tensor of order 5 in the \"classical\" case, or a state of 5 quantum systems in the quantum case. Applying the ``prepositional_phrase`` :term:`rewriting rule <rewrite rule>` to the diagram takes advantage of the underlying :term:`compact-closed <compact closed category>` monoidal structure, by using a \":term:`cap`\" to bridge the discontinued subject noun wire within the preposition tensor. Furthermore, the ``determiner`` :term:`rewriting rule <rewrite rule>` will apply a :term:`cap` on type :math:`n \\cdot n^l`, eliminating completely the determiner \"the\"."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAyYAAAF2CAYAAACbJozsAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAjDklEQVR4nO3df5TddX3v+9ebhDCB/BQkoCIcAatgcZ2orQpVhGituA4takv9VYq/eu6ysbqqnKILeyuL5e9Wj9XiZdF6XN5e6r3WWrC9hgCH+usW2qP88CeFBEQIKiQhkIEkfO4fswNDksnPmfnMTB6PtT5rf2fvPTPvvcMevs/57r2nWmsBAADo6YDeAwAAAAgTAACgO2ECAAB0J0wAAIDuhAkAANCdMAEAALoTJgAAQHfCBAAA6E6YAAAA3QkTAACgO2ECAAB0J0wAAIDuhAkAANCdMAEAALoTJgAAQHfCBAAA6E6YAAAA3QkTAACgO2ECAAB0J0wAAIDuhAkAANCdMAEAALoTJgAAQHfCBAAA6E6YAAAA3QkTAACgO2ECAAB0J0wAAIDuhAkAANCdMAEAALoTJgAAQHfCBAAA6E6YAAAA3QkTAACgO2ECAAB0J0wAAIDuZvceYE/MnTv37uHh4SW95xgaGlqzcePGI3rPAQAAM8W0OmIyPDy8pLWWvVm33XZbkuSOO+7Yq88fvaZCHAEAwEwyrcJkR0499dRceOGFvccAAAD2wbQPEwAAYPqbUWFyww035LTTTsvixYvztKc9LRdeeGG2bNnyuOtcffXVOeGEEzJ//vy87GUvy1133fXoZcccc0wuuuiinH766Zk3b16e9axn5Zvf/OZk3wwAANjvzJgwWbduXV760pfmJS95Se6+++5cccUVufTSS/Pxj3/8cde77LLLcu211+bOO+/MAw88kAsuuOBxl1966aX55Cc/+ejX+73f+73JvBkAALBfmjFhcsUVV2TOnDl53/vel4MOOijPfOYzc9555+WSSy553PXe//7357DDDsuCBQvy2te+Ntdff/3jLn/b296WE088MbNmzcqb3/zm3HLLLVm3bt1k3hQAANjvzJgwueOOO3L00Uenqh4979hjj80dd9zxuOsdeeSRj24fcsghuf/++3d6eZLtrgMAAIyvGRMmRx11VFavXp3W2qPn3XrrrTnqqKM6TgUAAOyOGRMmZ5xxRh566KFcdNFFefjhh/PDH/4wH/rQh/KmN72p92gAAMAuzIgwqaosXLgwX/va13LllVdmyZIl+fVf//W88Y1vzLve9a7e4wEAALtQo5/6NNVVVdt23qVLl+Ztb3tb3va2t03mHGmt1a6vCQAA7I5pfcTkO9/5Tm666aY8//nP7z0KAACwD2b3HmBvnX322fn617+eiy66KM9+9rN7jwMAAOyDafVUrrlz5949PDy8pPccQ0NDazZu3HhE7zkAAGCmmFZhsq+q6hlJvtxae0bvWQAAgMdM69eYAAAAM4MwAQAAuhMmAABAd8IEAADoTphso6pWVdX5VbWyqjZU1U1V9cLecwEAwEwmTHbs3CTLkyxMsiLJ5/qOAwAAM5sw2bGLW2s3t9a2JLkkyXFVtbD3UAAAMFMJkx27a9T2A4PT+T0GAQCA/YEwAQAAuhMmAABAd8IEAADobnbvAaaa1tox23y8Kkl1GQYAAPYTwmSamzt37t3Dw8NLes/B9oaGhtZs3LjxiN5zAABMB8JkmhseHl7SWus9xri45pprsmzZsmzevDlJcs4552T27Nm55JJLOk+2d6pKMAIA7CavMQEAALoTJgAAQHfChH32pS99KU9/+tMf/fiCCy5IVeXWW29Nkvzrv/5rFi5cmPXr1+ess87KEUcckQULFmTp0qVZsWLFbn+fCy+8ME9/+tPz4x//OA899FDe+ta35vDDD8+CBQty/PHH54tf/OK43zYAACaHMGGfnXbaabn11ltz++23J0lWrFiR4447LldeeeWjH7/4xS/OAQcckLPOOis//vGP84tf/CK/+7u/m1e96lX52c9+ttOvv2nTppx77rn56le/mm9+85s5/vjj87nPfS7XXXddvv/972f9+vW56qqrcuKJJ074bQUAYGIIE/bZokWLsnTp0lx55ZVZv359br755rz3ve999GjIlVdemWXLlmXevHl5/etfn/nz5+fAAw/Mu9/97syZMyfXXXfdmF973bp1+Y3f+I1H4+Owww5LksyZMycbNmzI9773vWzevDlHHXVUTjjhhEm5vQAAjD9hwrhYtmxZrrzyylx99dV5wQtekFe84hW5+uqrs2HDhnzrW9/KsmXLsnHjxrz97W/P0572tCxYsCCLFi3Kfffdt9MjJv/yL/+Sb3zjG/nABz6QoaGhR89//etfnze/+c15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\n",
      "text/plain": [
       "<Figure size 792x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from lambeq import Rewriter\n",
    "\n",
    "# Apply rewrite rule for prepositional phrases\n",
    "\n",
    "rewriter = Rewriter(['prepositional_phrase', 'determiner'])\n",
    "rewritten_diagram = rewriter(diagram)\n",
    "\n",
    "rewritten_diagram.draw(figsize=(11,5), fontsize=13)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will now ask `lambeq` to normalise the diagram, by \"stretching\" the wires and re-arranging the boxes if required:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAApYAAAEuCAYAAAA0g1KPAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAZG0lEQVR4nO3df7BfdX3n8dcbQrj5nQxIQItmMWD5UepGnRZhV34EWkSrRTpDEa0FhOlOjZZR2cEudmyW9Xcta4fCMIwMs1OpyK4VbBcS4lJKOwU7KiBVaAy/CRRMLoEEQvzsH/cGwo9ELpzc8733Ph4zZ77n+/O+z1fm+sw593u+1VoLAAC8Wrv0PQAAAJODsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPCEgCATghLAAA6ISwBAOiEsAQAoBPT+h7gpcyYMeOhTZs2Lex7jrEYGhpau3Hjxr37ngMAoC/VWut7hhepqjaIc+1IVaW1Vn3PAQDQF4fCAQDoxKQPyzVr1qSqct999/U9CgDApDZhw/LII4/M8uXL+x4DAIBREzYsAQAYLJMiLH/4wx/m6KOPzoIFC7Lffvtl+fLl2bJly/Mes2rVqhx00EGZM2dOjjvuuDz44IPP3rdo0aKcf/75OeaYYzJ79uwccsghuemmm8Z7MwAAJrQJH5br16/Psccem6OOOioPPfRQrrnmmlx66aX58pe//LzHXXHFFbnhhhty//3354knnsh55533vPsvvfTSXHDBBc++3u/93u+N52YAAEx4Ez4sr7nmmkyfPj1//Md/nN133z0HHnhgzjnnnFxyySXPe9ynP/3p7Lnnnpk7d25OOeWU3HLLLc+7/6yzzsrBBx+cXXfdNWeccUbuuuuurF+/fjw3BQBgQpvwYXnvvffmDW94Q6qeO4XkG9/4xtx7773Pe9w+++zz7PqsWbPy+OOP7/D+JC96DAAA2zfhw3LffffN3XffnW1PqL569ersu+++PU4FADD1TPiwPOGEE/LUU0/l/PPPz9NPP50f//jH+dznPpfTTz+979EAAKaUCR2WVZV58+bl2muvzYoVK7Jw4cL8xm/8Rj74wQ/m7LPP7ns8AIApZcJ+V/iSJUty1lln5ayzzhqnqXbMd4UDAFPdhNxj+f3vfz+33XZbfv3Xf73vUQAAGDWt7wHG6uSTT86NN96Y888/P7/6q7/a9zgAAIyasIfCB41D4QDAVDchD4UDADB4BvJQ+NDQ0NqqWtj3HGMxNDS0tu8ZAAD6NJCHwneGqnpzkq+11t7c8ygAAJOSQ+EAAHRCWAIA0AlhCQBAJ4QlAACdEJYAAHRCWL6EqlpTVedW1cqq2lBVt1XV2/ueCwBgkAnL7TstybIk85Jcl+SyfscBABhswnL7Lmqt3d5a25LkkiSLq2pe30MBAAwqYbl9D26z/sTo5Zw+BgEAmAiEJQAAnRCWAAB0QlgCANCJaX0PMIhaa4tecH1NkuplGACACcIeSwAAOiEsAQDohEPhU9iMGTMe2rRp08K+52AwDQ0Nrd24cePefc8BwMQhLKewTZs2LWyt9T0GA6qq/KMDgDFxKBwAgE4IS9jGd7/73Uyb9tyO/A996EM544wzepwIACYOYQkAQCeEJQAAnRCWTApXXXVVDjjggGevn3feeamqrF69Oknyz//8z5k3b16Gh4dz4oknZu+9987cuXOzZMmSXHfddS/75yxfvjwHHHBA7rzzzjz11FM588wzs9dee2Xu3LnZf//9841vfKPzbQOAiUJYMikcffTRWb16de65554kyXXXXZfFixdnxYoVz15/xzvekV122SUnnnhi7rzzzjz66KP53d/93bzvfe/LI488ssPX37x5c0477bR85zvfyU033ZT9998/l112WW6++ebccccdGR4ezvXXX5+DDz54p28rAAwqYcmkMH/+/CxZsiQrVqzI8PBwbr/99nzqU596dm/kihUrsnTp0syePTunnnpq5syZk9122y2f+MQnMn369Nx8883bfe3169fn+OOPfzYe99xzzyTJ9OnTs2HDhvzoRz/KM888k3333TcHHXTQuGwvAAwiYcmksXTp0qxYsSKrVq3KYYcdlne+851ZtWpVNmzYkH/8x3/M0qVLs3HjxvzhH/5h9ttvv8ydOzfz58/Pz372sx3usfz7v//7/MM//EP+9E//NENDQ8/efuqpp+aMM87IH/3RH2WPPfbIiSeemLvuums8NhUABpKwZNJYunRprr/++lx33XU5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\n",
      "text/plain": [
       "<Figure size 648x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "normalised_diagram = rewritten_diagram.normal_form()\n",
    "normalised_diagram.draw(figsize=(9,4), fontsize=13)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the simplified diagram, the order of the preposition tensor is reduced by 2, which at least for a classical experiment, is a substantial improvement. Note also that the determiner is now eliminated, equating the meaning of the noun phrase \"the park\" with that of the noun \"park\"."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "These examples clearly demonstrate the flexibility of :term:`string diagrams <string diagram>` compared to simple :term:`tensor networks <tensor network>`, which was one of the main reasons for choosing them as ``lambeq``'s representation format. ``lambeq`` comes with a number of standard :term:`rewrite rules <rewrite rule>` covering auxiliary verbs, connectors, coordinators, adverbs, determiners, relative pronouns, and prepositional phrases."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| Rewrite rule             | Description                                                                    |\n",
    "+==========================+================================================================================+\n",
    "| ``auxiliary``            | Removes auxiliary verbs (such as \"do\") by replacing them with caps.            |\n",
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| ``connector``            | Removes sentence connectors (such as \"that\") by replacing them with caps.      |\n",
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| ``coordination``         | Simplifies \"and\" by replacing it with a layer of interleaving spiders.         |\n",
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| ``determiner``           | Removes determiners (such as \"the\") by replacing them with caps.               |\n",
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| ``object_rel_pronoun``   | Simplifies relative pronouns (such as \"that\") using cups, spiders and a loop.  |\n",
    "|                          |                                                                                |\n",
    "| ``subject_rel_pronoun``  |                                                                                |\n",
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| ``postadverb``           | Simplifies adverbs by passing through the noun wire transparently using a cap. |\n",
    "|                          |                                                                                |\n",
    "| ``preadverb``            |                                                                                |\n",
    "+--------------------------+--------------------------------------------------------------------------------+\n",
    "| ``prepositional_phrase`` | Simplifies prepositions by passing through the noun wire using a cap.          |\n",
    "+--------------------------+--------------------------------------------------------------------------------+"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. rubric:: See also:\n",
    "\n",
    "- :ref:`lambeq.rewrite package <api_rewrite>`\n",
    "- `Example notebook rewrite.ipynb <../examples/rewrite.ipynb>`_\n",
    "- `DisCoCat in DisCoPy <./discocat.ipynb>`_\n",
    "- `Extending lambeq <./extend-lambeq.ipynb>`_"
   ]
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
