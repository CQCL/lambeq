{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "672c7718",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Classical pipeline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bd8ae721-637c-47a0-b8a2-b966f2da492e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from discopy.tensor import Tensor\n",
    "import tensornetwork as tn\n",
    "import torch\n",
    "\n",
    "np = Tensor.np = torch\n",
    "tn.set_default_backend('pytorch')\n",
    "torch.array = torch.as_tensor\n",
    "torch.cuda.set_device(0)\n",
    "torch.manual_seed(0)\n",
    "torch.set_default_tensor_type(torch.cuda.FloatTensor)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f13b020a-1b9f-442a-8a3f-370cf57ac45c",
   "metadata": {
    "tags": []
   },
   "source": [
    "### Input data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2dc5185b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def read_data(filename):\n",
    "    labels, sentences = [], []\n",
    "    with open(filename) as f:\n",
    "        for line in f:\n",
    "            labels.append(int(line[0]))\n",
    "            sentences.append(line[1:].strip())\n",
    "    return torch.as_tensor(labels, dtype=torch.float32), sentences\n",
    "\n",
    "\n",
    "train_labels, train_data = read_data('datasets/mc_train_data.txt')\n",
    "dev_labels, dev_data = read_data('datasets/mc_dev_data.txt')\n",
    "test_labels, test_data = read_data('datasets/mc_test_data.txt')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "color-reservoir",
   "metadata": {
    "tags": []
   },
   "source": [
    "### Create diagrams"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "540e07d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "from lambeq.ccg2discocat import DepCCGParser\n",
    "\n",
    "reader = DepCCGParser(possible_root_cats=['S[dcl]'])\n",
    "\n",
    "train_diagrams = reader.sentences2diagrams(train_data)\n",
    "dev_diagrams = reader.sentences2diagrams(dev_data)\n",
    "test_diagrams = reader.sentences2diagrams(test_data)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "organizational-dominant",
   "metadata": {},
   "source": [
    "### Create circuits"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4c55e29a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAb4AAAEuCAYAAADx63eqAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8rg+JYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAfxUlEQVR4nO3dfZBV9Z3n8fdXQRtFER+jgNNOJKLSLYiA2Jo4CvEhShyVJSwSa2bIbHwq1CTgjCYxjjOVcR2NoEZj3IIx6lCKuxmzWUUsdQFFhbYTsMGnWqIQRFEEURpo+e0ffbsFpZum6b6n+573q+rUOffcc8/5/q54P/07j5FSQpKkvNgj6wIkSSomg0+SlCsGnyQpVww+SVKuGHySpFwx+CRJuWLwSZJyxeCTJOWKwSdJyhWDT5KUKwafJClXDD5JUq4YfJKkXDH4JEm5YvBJknLF4JMk5YrBJ0nKFYNPkpQrBp8kKVcMPklSrhh8kqRcMfgkSbli8EmScsXgkyTlisEnScoVg0+SlCsGnyQpVww+SVKuGHySpFwx+CRJudKtmBvr0aPHu3V1dYcVc5uloKysbPXGjRu/knUdklQKIqVUvI1FpGJur1REBCmlyLoOSSoF7uqUJOVKyQRfeXk5a9as+dL8U045BYDly5czcOBAAJ599lnOO+88ADZt2sTIkSMZNGgQM2fObHb906dP58orr2z2/U2bNjF27FiOPvpohg8fzvLly3ejNZKkjlLUY3xZeP7551t8/5VXXgGgpqZmt7Zz//3307t3b958803+4z/+gylTprQYpJKkbHTJHt8nn3zCt771LU444QQGDhy4XcBs3LiRc845h/vuuw+Anj17Nrue9957j0suuYSXX36ZQYMG8dZbb23Xc1y4cCGnn356q2r67W9/y6WXXgrAxRdfzNNPP43HMyWp8+mSwffEE09wxBFH8Ic//IElS5Zw9tlnA7BhwwbOP/98xo0bx/e+972drufQQw/l17/+Naeddho1NTV89atfbXNNK1eupF+/fgB069aNXr168cEHH7R5fZKkjtElg6+iooKnnnqKKVOmMHfuXHr16gXAt7/9bf7mb/6G7373uxlXKEnqrLpk8H3ta1+jurqaiooKbrjhBm666SYAqqqqeOKJJ3ZrF2O3bt3YunUrAHV1da3+XJ8+fXjnnXcAqK+vZ926dRx00EFtrkOS1DG6ZPD9+c9/Zp999uGSSy7hRz/6EdXV1QDcdNNN9O7dmyuuuKLN6y4vL2fRokUAzJo1q9WfGz16NDNmzADg0Ucf5YwzziDCS+8kqbPpksG3ePFihg0bxqBBg/jZz37GDTfc0PTeHXfcwcaNG5k8eXKb1v3Tn/6USZMmcdJJJ7Hnnnu2+nN/93d/xwcffMDRRx/Nbbfdxs9//vM2bV+S1LG8c0sX4J1bJKn9dMkenyRJbVXyF7C3t3/+53/mkUce2W7emDFjuP766zOqSJK0K4q6q9OnM7SNT2eQpPZT1ODbVRExDXg9pTQt61raQ0QMA+5MKQ3LuhZJyiuP8UmScqXLBl9E9IuIZyKiNiJejYhJWde0O0qtPZLUWXXlk1vqgR+klKojYj9gUUQ8lVKqzbqwNiq19khSp9Rle3wppVUpperC9MfAUqBPtlW1Xam1R5I6qy4bfNuKiHJgMPBixqW0i1JrjyR1Jl0++CKiJzALuDqltD7renZXqbVHkjqbLh18EdGdhpB4MKX0WNb17K5Sa48kdUZdNvii4dEH9wNLU0q3ZV3P7iq19khSZ9Vlgw+oAiYAZ0RETWE4N+uidkOptUeSOqUuezlDSmkeUDJPLCi19khSZ9WVe3ySJO2yLtvjU8co1o3EvfG2pKwYfNpOXV3dYcW4cXlE+JQOSZlwV6ckKVcMPhXVokWLqKioACAiphYu45CkojH4VFSXXXYZ9913X+PL/sDZGZYjKYcMPhER5RGxLCKmA4wfP545c+ZQVVVF//79eemll3jppZcYMWIEgwcP5pRTTuG1114DYPr06Vx44YWcffbZ9O/fn8mTJze7nVWrVrF+/XpOPvnkxln/DlzQoY2TpC8w+NToaODfAJYtW8ZDDz3EvHnzuPXWW/mXf/kXBgwYwNy5c3nllVe46aab+Md//MemD9bU1DBz5kwWL17MzJkzeeedd3a4gZUrV9K3b99tZ63AJ1BIKjLP6lSj/5dSWhwRHH/88Zx55plEBBUVFSxfvpx169Zx6aWX8sYbbxARbNmypemDZ555Jr169QLguOOO409/+hP9+vXLqh2S1CJ7fGq0qXFijz32YO+9926arq+v58c//jF/9Vd/xZIlS3j88cepq6tr+mDjsgB77rkn9fX1O9xAnz59WLFixbaz+gIr27UVkrQTBp9aZd26dfTp07BXcvr06W1ax+GHH87+++/PggULGmd9F/hte9QnSa1l8KlVJk+ezD/8wz8wePDgZnt0rXH33XczceLExpdvAf+nPeqTpNaKYtylo60iYhrwekppWta1tIeIGAbcmVIalnUtzYmIVKQ7t5BS8ho+SUVnj0+SlCue1akOMXz4cDZt2rTdvAceeKDpri2SlBWDT9spKytb3VE3kK6srNxuOx2xDUnaGYNP29nVRwVFxDLggpTSsg4qSZLalcf4JEm5YvCpw0REv4h4JiJqI+LViJiUdU2S5K5OdaR64AcppeqI2A9YFBFPpZRqsy5MUn7Z41OHSSmtSilVF6Y/BpbiTaklZczgU1FERDkwGHgx41Ik5ZzBpw4XET2BWcDVKaX1WdcjKd8MPnWoiOhOQ+g9mFJ6LOt6JMngU4eJiADuB5amlG7Luh5JAoNPHasKmACcERE1heHcrIuSlG9ezqAOk1KaB/gEBkmdij0+SVKuGHySpFxxV6dKWo8ePd6tq6vrkKdNlLKysrLVu3rDcqmrMPhU0urq6g4rxhPlS01HPZpK6gzc1SmVoBkzZtC/f3/69+/PjBkzsi5H6lTs8Ult8Nlnn7Hnnnu2+3rr6+vp1m33/rf88MMP+dnPfsbChQuJCIYMGcLo0aPp3bt3O1UpdW32+KQvWL58OQMGDGD8+PEce+yxXHzxxXz66aeUl5czZcoUTjzxRB555BFmz57NiBEjOPHEExkzZgwbNmwAoLy8nMmTJ1NRUcGwYcN48803AXj88ccZPnw4gwcPZuTIkaxe3fAQ+htvvJEJEyZQVVXFhAkTeP/997nooosYOnQoQ4cOZf78+QA899xzDBo0iEGDBjF48GA+/vjjHdb/5JNPMmrUKA488EB69+7NqFGjeOKJJ4rwzUldg8En7cBrr73G5ZdfztKlS9l///25++67ATjooIOorq5m5MiR3HzzzcyZM4fq6mpOOukkbrvt85vT9OrVi8WLF3PllVdy9dVXA3DqqaeyYMECXnnlFb7zne9wyy23NC1fW1vLnDlzePjhh5k0aRLXXHMNL7/8MrNmzWLixIkA3Hrrrdx1113U1NQwd+5cevToscPaV65cSb9+/Zpe9+3bl5UrV7b3VyR1We7qlHagX79+VFVVAXDJJZcwdepUAMaOHQvAggULqK2tbVpm8+bNjBgxounz48aNaxpfc801AKxYsYKxY8eyatUqNm/ezFFHHdW0/OjRo5uCbM6cOdTWfv7IwvXr17Nhwwaqqqq49tprGT9+PBdeeCF9+/btqOZLJc0en7QDDbcZ/fLrfffdF4CUEqNGjaKmpoaamhpqa2u5//77d/j5xumrrrqKK6+8ksWLF3PvvfdSV1fXtEzjegG2bt3KggULmta9cuVKevbsyXXXXcevf/1rNm7cSFVVFcuWLdth7X369OGdd95per1ixQr69PExiFIjg0/agbfffpsXXngBgIceeohTTz11u/dPPvlk5s+f33T87pNPPuH1119ven/mzJlN48ae4Lp165oCqKUzLb/5zW8ybdq0ptc1NTUAvPXWW1RUVDBlyhSGDh3abPCdddZZzJ49m7Vr17J27Vpmz57NWWedtSvNl0qawSftwDHHHMNdd93Fsccey9q1a7nsssu2e/+QQw5h+vTpjBs3jsrKSkaMGLFdEK1du5bKykruuOMObr/9dqDhJJYxY8YwZMgQDj744Ga3PXXqVBYuXEhlZSXHHXcc99xzDwC/+MUvGDhwIJWVlXTv3p1zzjlnh58/8MAD+fGPf9x0csxPfvITDjzwwN39SqSSEZ354t6ImAa8nlKattOFu4CIGAbcmVIalnUt7SUilgEXpJR23P3IWESkXf03vnz5cs477zyWLFnSpm2Wl5ezcOHCFsOts4sIUkreYFwlyR6fJClXPKtT+oLy8vI29/agocdYDIsXL2bChAnbzdt777158cUXi7J9qasy+FTSysrKVuftvpNfPCO1LcrKyla3QylSp2TwqaTt6hMGIuJ6YJ+U0vUdVFJRRcSRwLyU0pFZ1yJ1Fh7jkyTlisEnScoVg09qpYjoFxHPRERtRLwaEZOyrml3lFp7pNbyGJ/UevXAD1JK1RGxH7AoIp5KKdXu7IOdVKm1R2oVe3xSK6WUVqWUqgvTHwNLgS57E8xSa4/UWgaf1AYRUQ4MBkriorlSa4/UEoNP2kUR0ROYBVydUlqfdT27q9TaI+2MwSftgojoTkNIPJhSeizrenZXqbVHag2DT2qlaLglyv3A0pTSbTtbvrMrtfZIrWXwSa1XBUwAzoiImsJwbtZF7YZSa4/UKl7OILVSSmkeUDKP6im19kitZY9PkpQr9vgkZapHjx7v1tXV5eoJGu2hrKxs9a7ehF0NDD5JmaqrqzsspZR1GV1O3h631Z7c1SlJyhWDT5KK7Oyzz+aAAw7gvPPOy7qUXDL4JJWczz77rEPWW19f3y7r+dGPfsQDDzzQLuvSrjP4JHUpy5cvZ8CAAYwfP55jjz2Wiy++mE8//ZTy8nKmTJnCiSeeyCOPPMLs2bMZMWIEJ554ImPGjGHDhg0AlJeXM3nyZCoqKhg2bBhvvvkmAI8//jjDhw9n8ODBjBw5ktWrVwNw4403MmHCBKqqqpgwYQLvv/8+F110EUOHDmXo0KHMnz8fgOeee45BgwYxaNAgBg8ezMcff9xsG84880z222+/Dv6m1ByDT1KX89prr3H55ZezdOlS9t9/f+6++24ADjroIKqrqxk5ciQ333wzc+bMobq6mpNOOonbbvv85jS9evVi8eLFXHnllVx99dUAnHrqqSxYsIBXXnmF73znO9xyyy1Ny9fW1jJnzhwefvhhJk2axDXXXMPLL7/MrFmzmDhxIgC33nord911FzU1NcydO5cePXoU7wvRLvGsTkldTr9+/aiqqgLgkksuYerUqQCMHTsWgAULFlBbW9u0zObNmxkxYkTT58eNG9c0vuaaawBYsWIFY8eOZdWqVWzevJmjjjqqafnRo0c3BdmcOXOorf38kYXr169nw4YNVFVVce211zJ+/HguvPBC+vbt21HN124y+CR1OQ23Gf3y63333ReAlBKjRo3i4Ycf3unnG6evuuoqrr32WkaPHs2zzz7LjTfe2LRM43oBtm7dyoIFCygrK9tunddddx3f+ta3+P3vf09VVRVPPvkkAwYMaHsj1WHc1Smpy3n77bd54YUXAHjooYc49dRTt3v/5JNPZv78+U3H7z755BNef/31pvdnzpzZNG7sCa5bt44+fRqewztjxoxmt/3Nb36TadOmNb2uqakB4K233qKiooIpU6YwdOhQli1btputVEcx+CR1Occccwx33XUXxx57LGvXruWyyy7b7v1DDjmE6dOnM27cOCorKxkxYsR2QbR27VoqKyu54447uP3224GGk1jGjBnDkCFDOPjgg5vd9tSpU1m4cCGVlZUcd9xx3HPPPQD84he/YODAgVRWVtK9e3fOOeecZtdx2mmnMWbMGJ5++mn69u3Lk08+uTtfh3ZRdOY7JkTENOD1lNK0nS7cBUTEMODOlNKwrGtpLxGxDLggpVQSf95GxPXAPiml67Ou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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from discopy import Dim\n",
    "\n",
    "from lambeq.tensor import SpiderAnsatz\n",
    "from lambeq.core.types import AtomicType\n",
    "\n",
    "ansatz = SpiderAnsatz({AtomicType.NOUN: Dim(2),\n",
    "                       AtomicType.SENTENCE: Dim(2)})\n",
    "\n",
    "train_circuits = [ansatz(diagram) for diagram in train_diagrams]\n",
    "dev_circuits =  [ansatz(diagram) for diagram in dev_diagrams]\n",
    "test_circuits = [ansatz(diagram) for diagram in test_diagrams]\n",
    "\n",
    "train_circuits[0].draw()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a02dd1f",
   "metadata": {},
   "source": [
    "### Parameterise"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "867c15fc-9695-42ff-959c-1415bc2a7653",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sympy import default_sort_key\n",
    "\n",
    "all_circuits = train_circuits + dev_circuits + test_circuits\n",
    "\n",
    "# sort the symbols since they are returned as a set\n",
    "parameters = sorted(\n",
    "    {s for circ in all_circuits for s in circ.free_symbols},\n",
    "    key=default_sort_key)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "exact-coating",
   "metadata": {},
   "outputs": [],
   "source": [
    "def make_pred_fn(circuits):\n",
    "    def predict(params):\n",
    "        return torch.stack(\n",
    "            [c.lambdify(*parameters)(*params).eval(contractor=tn.contractors.auto).array\n",
    "             for c in circuits])\n",
    "    return predict\n",
    "\n",
    "\n",
    "train_pred_fn = make_pred_fn(train_circuits)\n",
    "dev_pred_fn = make_pred_fn(dev_circuits)\n",
    "test_pred_fn = make_pred_fn(test_circuits)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "architectural-mainland",
   "metadata": {},
   "source": [
    "### Train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "1ef339b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "def train(func, x0, niter, callback, optimizer_fn, lr):\n",
    "    x = [t.detach().requires_grad_() for t in x0]\n",
    "    optimizer = optimizer_fn(x, lr=lr)\n",
    "    for _ in range(niter):\n",
    "        loss = func(x)\n",
    "\n",
    "        optimizer.zero_grad()\n",
    "        loss.backward()\n",
    "        optimizer.step()\n",
    "\n",
    "        with torch.no_grad():\n",
    "            callback(x)\n",
    "    return x\n",
    "\n",
    "\n",
    "def make_cost_fn(pred_fn, labels):\n",
    "    def cost_fn(params, **kwargs):\n",
    "        predictions = pred_fn(params)\n",
    "        \n",
    "        logits = predictions[:, 1] - predictions[:, 0]\n",
    "\n",
    "        loss_fn = torch.nn.BCEWithLogitsLoss()\n",
    "        cost = loss_fn(logits, labels)\n",
    "        costs.append(cost.item())\n",
    "        \n",
    "        with torch.no_grad():\n",
    "            acc = np.sum((logits > 0) == labels) / len(labels)\n",
    "            accuracies.append(acc.item())\n",
    "            \n",
    "        return cost\n",
    "\n",
    "    costs, accuracies = [], []\n",
    "    return cost_fn, costs, accuracies\n",
    "\n",
    "\n",
    "x0 = [torch.nn.init.uniform_(torch.empty(p.size)) for p in parameters]\n",
    "\n",
    "train_cost_fn, train_costs, train_accs = make_cost_fn(train_pred_fn, train_labels)\n",
    "dev_cost_fn, dev_costs, dev_accs = make_cost_fn(dev_pred_fn, dev_labels)\n",
    "\n",
    "result = train(train_cost_fn, x0, niter=20, callback=dev_cost_fn,\n",
    "               optimizer_fn=torch.optim.AdamW, lr=0.1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "beautiful-jesus",
   "metadata": {
    "tags": []
   },
   "source": [
    "### Show results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "connected-dominican",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Test accuracy: 1.0\n"
     ]
    },
    {
     "data": {
      "image/png": "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s1HAKIAWLVoEK6+IZ8yM5PgYkuNjaJ2atM/ly3yO7cWlbC8uo6Bot+fiUrYXBZ6Ly8gvKqW41EdpmY8Sn6O0zEdpmdv1uqTMUeoLzCvzUVjio8xXhnMOB/icw+fzPzsXmP7da3D4pwF2/wq18zuV47f3UxIi55ogtV9SE0VZFKm1UkmtlcqhDQ/9w/vOOTYXbmZt/lryivMoLC1kR9kOikqLKCwrpLC08LfnwOui0iJ2lO6gxJXg8/nwOR9lroxSXyk+99t0+eedD9jZzrjfPe/Msuv9wHu7clKuQfrdyz0sU0kntDxhvz9TkRrREjrnngeeB3+fCo/jiHguOspISYglJUE39g11ar8kHJnZriJNDlwwO4usAZqXm04PzKtwGTOLAerg76AvIiIiEtaCWYTNBNqbWWsziwPOBibutsxE4MLA6zOAL9QfTERERCJB0E5HBvp4XQV8jH+IipeccwvN7C4gwzk3EXgReM3MlgFb8BdqIiIiImEvqH3CnHNTgCm7zbu93OtC4MxgZhAREREJRRpASERERMQDNe62RWaWDazaj4+kstuQF2Eu0vYXtM+RoKVzrsbfT0XtV6VE2j5H2v5C5O3zHtuvGleE7S8zywiH251UVqTtL2ifJXxF4s850vY50vYXInOf90SnI0VEREQ8oCJMRERExAORUIQ973WAahZp+wvaZwlfkfhzjrR9jrT9hcjc5wqFfZ8wERERkVAUCUfCREREREKOijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD6gIExEREfGAijARERERD8R4HWB/paamulatWnkdQ0Sq0axZszY55xp6neNgqf0SiTx7a79qXBHWqlUrMjIyvI4hItXIzFZ5naEqqP0SiTx7a790OlJERETEA0ErwszsJTPbaGYL9vC+mdnjZrbMzOaZWa9gZREREREJNcE8EjYeGLyX94cA7QOPUcAzQcwiIiIiElKC1ifMOfeNmbXayyIjgFedcw6YbmZ1zaypc25dsDJJGFr+Naz9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\n",
      "text/plain": [
       "<Figure size 720x432 with 4 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ((ax_tl, ax_tr), (ax_bl, ax_br)) = plt.subplots(2, 2, sharex=True, sharey='row', figsize=(10, 6))\n",
    "ax_tl.set_title('Training set')\n",
    "ax_tr.set_title('Development set')\n",
    "ax_bl.set_xlabel('Iterations')\n",
    "ax_br.set_xlabel('Iterations')\n",
    "ax_bl.set_ylabel('Accuracy')\n",
    "ax_tl.set_ylabel('Loss')\n",
    "\n",
    "colours = iter(plt.rcParams['axes.prop_cycle'].by_key()['color'])\n",
    "ax_tl.plot(train_costs, color=next(colours))\n",
    "ax_bl.plot(train_accs, color=next(colours))\n",
    "ax_tr.plot(dev_costs, color=next(colours))\n",
    "ax_br.plot(dev_accs, color=next(colours))\n",
    "\n",
    "# print test accuracy\n",
    "test_cost_fn, _, test_accs = make_cost_fn(test_pred_fn, test_labels)\n",
    "test_cost_fn(result)\n",
    "print('Test accuracy:', test_accs[0])"
   ]
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
